### 1. C/CPP程序内存结构

一个典型的C程序内存结构包括一下部分：
+ Text segment（代码段）
+ Initialized data segment（初始化数据段）
+ Uninitialized data segment（未初始化数据段，BSS段）
+ Heap（堆区）
+ STack（栈区）

示意图如下所示：

![](https://raw.githubusercontent.com/fengz63/picture/main/memoryLayoutC.jpg)

+ 1. 代码段
    代码段包括可执行指令。作为内存中的一个区域，代码段在内存中位于堆或者栈下方，防止堆栈溢出时覆盖掉其内容。

        通常代码段是只读的，以防止程序意外地修改其指令。

+ 2. 已初始化数据段
    数据段是程序虚拟地址空间的一部分，它包含已经**初始化的全局变量和静态变量**。数据段并不是只读的，因为变量的值可以随时被修改。

        数据段更进一步细化为**只读数据区**和**读写数据区**。例如，对于一个全聚德字符串定义如下```char s[] = "hello world"```，此变量被存储在可读写区域。然而对于一个常量，如```const char* str = "hello world"```，此字符串被存储在只读数据区

+ 3. BSS段
    BSS（Block Started by Symbol）段中的数据在程序开始执行之前被内核算数初始化为0。BSS段中包含所有的**未初始化的全局变量和静态变量**。例如，一个静态变量```static int i```和全局变量```int j```，将被包含在BSS段中。

+ 4. 栈段
    由编译器自动释放，存放函数的参数值、局部变量等。每当一个函数被调用时，该函数的返回类型和一些调用的信息被存放到栈中。然后这个被调用的函数再为他的自动变量和临时变量在栈上分配空间。每调用一个函数一个新的栈就会被使用。栈区是从高地址位向低地址位增长的，是一块连续的内存区域，最大容量是由系统预先定义好的，申请的栈空间超过这个界限时会提示溢出，用户能从栈中获取的空间较小。

+ 5. 堆区：用于动态分配内存，位于BSS和栈中间的地址区域。由程序员申请分配和释放。堆是从低地址位向高地址位增长，采用链式存储结
    构。频繁的malloc/free造成内存空间的不连续，产生碎片。当申请堆空间时库函数是按照一定的算法搜索可用的足够大的空间。因此堆的效率比栈要大很多。

更多详细信息见：[Memroy layout of C progam](https://www.geeksforgeeks.org/memory-layout-of-c-program/)